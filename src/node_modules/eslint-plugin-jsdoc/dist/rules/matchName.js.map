{"version":3,"sources":["../../src/rules/matchName.js"],"names":["context","jsdoc","report","info","lastIndex","utils","match","options","allowName","disallowName","replacement","tags","allowNameRegex","getRegexFromString","disallowNameRegex","applicableTags","includes","getPresentTags","reported","tag","allowed","test","name","disallowed","hasRegex","fixer","src","source","tokens","replace","message","reportJSDoc","undefined","matchContext","meta","docs","description","url","fixable","schema","additionalProperies","properties","items","type","comment","required"],"mappings":"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","sourcesContent":["import iterateJsdoc from '../iterateJsdoc';\n\n// eslint-disable-next-line complexity\nexport default iterateJsdoc(({\n  context,\n  jsdoc,\n  report,\n  info: {\n    lastIndex,\n  },\n  utils,\n}) => {\n  const {\n    match,\n  } = context.options[0] || {};\n  if (!match) {\n    report('Rule `no-restricted-syntax` is missing a `match` option.');\n\n    return;\n  }\n\n  const {\n    allowName,\n    disallowName,\n    replacement,\n    tags = [\n      '*',\n    ],\n  } = match[lastIndex];\n\n  const allowNameRegex = allowName && utils.getRegexFromString(allowName);\n  const disallowNameRegex = disallowName && utils.getRegexFromString(disallowName);\n\n  let applicableTags = jsdoc.tags;\n  if (!tags.includes('*')) {\n    applicableTags = utils.getPresentTags(tags);\n  }\n\n  let reported = false;\n  for (const tag of applicableTags) {\n    const allowed = !allowNameRegex || allowNameRegex.test(tag.name);\n    const disallowed = disallowNameRegex && disallowNameRegex.test(tag.name);\n    const hasRegex = allowNameRegex || disallowNameRegex;\n    if (hasRegex && allowed && !disallowed) {\n      continue;\n    }\n\n    if (!hasRegex && reported) {\n      continue;\n    }\n\n    const fixer = () => {\n      for (const src of tag.source) {\n        if (src.tokens.name) {\n          src.tokens.name = src.tokens.name.replace(\n            disallowNameRegex, replacement,\n          );\n          break;\n        }\n      }\n    };\n\n    let {\n      message,\n    } = match[lastIndex];\n    if (!message) {\n      if (hasRegex) {\n        message = disallowed ?\n          `Only allowing names not matching \\`${disallowNameRegex}\\` but found \"${tag.name}\".` :\n          `Only allowing names matching \\`${allowNameRegex}\\` but found \"${tag.name}\".`;\n      } else {\n        message = `Prohibited context for \"${tag.name}\".`;\n      }\n    }\n\n    utils.reportJSDoc(\n      message,\n      hasRegex ? tag : null,\n\n      // We could match up\n      disallowNameRegex && replacement !== undefined ?\n        fixer :\n        null,\n      false,\n      {\n        // Could also supply `context`, `comment`, `tags`\n        allowName,\n        disallowName,\n        name: tag.name,\n      },\n    );\n    if (!hasRegex) {\n      reported = true;\n    }\n  }\n}, {\n  matchContext: true,\n  meta: {\n    docs: {\n      description: 'Reports the name portion of a JSDoc tag if matching or not matching a given regular expression.',\n      url: 'https://github.com/gajus/eslint-plugin-jsdoc#eslint-plugin-jsdoc-rules-match-name',\n    },\n    fixable: 'code',\n    schema: [\n      {\n        additionalProperies: false,\n        properties: {\n          match: {\n            additionalProperies: false,\n            items: {\n              properties: {\n                allowName: {\n                  type: 'string',\n                },\n                comment: {\n                  type: 'string',\n                },\n                context: {\n                  type: 'string',\n                },\n                disallowName: {\n                  type: 'string',\n                },\n                message: {\n                  type: 'string',\n                },\n                tags: {\n                  items: {\n                    type: 'string',\n                  },\n                  type: 'array',\n                },\n              },\n              type: 'object',\n            },\n            type: 'array',\n          },\n        },\n        required: [\n          'match',\n        ],\n        type: 'object',\n      },\n    ],\n    type: 'suggestion',\n  },\n});\n"],"file":"matchName.js"}